---
to: reports/{{reportType}}-{{reportDate | date('YYYY-MM-DD')}}.docx
variables:
  reportType: string
  reportTitle: string
  reportDate: date
  author: string
  department?: string
  complianceStandard?: string
  findings?: array
  recommendations?: array
inject: false
skipIf: "exists"
engine: "office"
---
{
  "document": {
    "properties": {
      "title": "{{reportTitle}}",
      "subject": "{{reportType | titleCase}} Report",
      "creator": "{{author}}",
      "description": "Generated by KGEN v1 on {{reportDate | date('YYYY-MM-DD')}}"
    },
    "styles": {
      "default": {
        "run": {
          "font": "Calibri",
          "size": 22
        }
      },
      "heading1": {
        "run": {
          "font": "Calibri",
          "size": 32,
          "bold": true,
          "color": "2F5496"
        },
        "paragraph": {
          "spacing": { "after": 240 }
        }
      },
      "heading2": {
        "run": {
          "font": "Calibri",
          "size": 28,
          "bold": true,
          "color": "2F5496"
        },
        "paragraph": {
          "spacing": { "before": 120, "after": 120 }
        }
      }
    },
    "sections": [
      {
        "properties": {
          "page": {
            "margin": {
              "top": 1134,
              "right": 850,
              "bottom": 1134,
              "left": 850
            }
          }
        },
        "headers": {
          "default": {
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "textRun",
                    "text": "{{reportType | titleCase}} Report - {{reportDate | date('MMMM YYYY')}}",
                    "style": "header"
                  }
                ],
                "alignment": "center"
              }
            ]
          }
        },
        "footers": {
          "default": {
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "textRun",
                    "text": "Generated by KGEN v1 - Page ",
                    "style": "footer"
                  },
                  {
                    "type": "pageNumber"
                  }
                ],
                "alignment": "center"
              }
            ]
          }
        },
        "children": [
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "{{reportTitle}}",
                "style": "heading1"
              }
            ],
            "alignment": "center"
          },
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Report Date: {{reportDate | date('MMMM DD, YYYY')}}"
              }
            ],
            "spacing": { "after": 120 }
          },
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Author: {{author}}"
              }
            ]
          },
          {% if department -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Department: {{department}}"
              }
            ]
          },
          {% endif -%}
          {% if complianceStandard -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Compliance Standard: {{complianceStandard}}"
              }
            ]
          },
          {% endif -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Executive Summary",
                "style": "heading2"
              }
            ]
          },
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "This {{reportType}} report was generated automatically using KGEN v1 deterministic generation. The report provides comprehensive analysis and recommendations based on current data and compliance requirements."
              }
            ],
            "spacing": { "after": 240 }
          },
          {% if findings and findings.length > 0 -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Key Findings",
                "style": "heading2"
              }
            ]
          },
          {% for finding in findings -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "\u2022 {{finding.title}}: {{finding.description}}",
                "style": "listItem"
              }
            ],
            "indent": {
              "left": 720
            }
          },
          {% if finding.impact -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "  Impact: {{finding.impact}}",
                "style": "listSubItem"
              }
            ],
            "indent": {
              "left": 1440
            }
          },
          {% endif -%}
          {% endfor -%}
          {% endif -%}
          {% if recommendations and recommendations.length > 0 -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Recommendations",
                "style": "heading2"
              }
            ]
          },
          {% for recommendation in recommendations -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "{{loop.index}}. {{recommendation.title}}",
                "style": "listNumbered"
              }
            ]
          },
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "{{recommendation.description}}"
              }
            ],
            "indent": {
              "left": 720
            }
          },
          {% if recommendation.priority -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Priority: {{recommendation.priority | titleCase}}",
                "style": {% if recommendation.priority == 'high' %}"highPriority"{% elif recommendation.priority == 'medium' %}"mediumPriority"{% else %}"lowPriority"{% endif %}
              }
            ],
            "indent": {
              "left": 720
            }
          },
          {% endif -%}
          {% if recommendation.timeline -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Timeline: {{recommendation.timeline}}"
              }
            ],
            "indent": {
              "left": 720
            }
          },
          {% endif -%}
          {% endfor -%}
          {% endif -%}
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Conclusion",
                "style": "heading2"
              }
            ]
          },
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "This report represents a comprehensive analysis generated through KGEN v1's deterministic engine. All findings and recommendations are based on current data and established compliance frameworks."
              }
            ]
          },
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "For questions regarding this report, please contact {{author}}{% if department %} in the {{department}} department{% endif %}."
              }
            ]
          },
          {
            "type": "paragraph",
            "children": [
              {
                "type": "textRun",
                "text": "Document Metadata",
                "style": "heading2"
              }
            ]
          },
          {
            "type": "table",
            "rows": [
              {
                "cells": [
                  {
                    "children": [
                      {
                        "type": "paragraph",
                        "children": [
                          {
                            "type": "textRun",
                            "text": "Generated By",
                            "bold": true
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "children": [
                      {
                        "type": "paragraph",
                        "children": [
                          {
                            "type": "textRun",
                            "text": "KGEN v1"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "cells": [
                  {
                    "children": [
                      {
                        "type": "paragraph",
                        "children": [
                          {
                            "type": "textRun",
                            "text": "Generation Date",
                            "bold": true
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "children": [
                      {
                        "type": "paragraph",
                        "children": [
                          {
                            "type": "textRun",
                            "text": "{{new Date().toISOString()}}"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "cells": [
                  {
                    "children": [
                      {
                        "type": "paragraph",
                        "children": [
                          {
                            "type": "textRun",
                            "text": "Template Version",
                            "bold": true
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "children": [
                      {
                        "type": "paragraph",
                        "children": [
                          {
                            "type": "textRun",
                            "text": "1.0.0"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}