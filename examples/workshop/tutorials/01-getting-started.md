# Tutorial 01: Getting Started with KGEN

## Overview

Welcome to KGEN! In this tutorial, you'll learn the fundamentals of deterministic code generation and create your first templates. By the end, you'll understand:

- KGEN core concepts and architecture
- How to create and use templates
- Deterministic generation principles
- Basic semantic validation

**Duration**: 30 minutes  
**Prerequisites**: Node.js 18+, basic programming knowledge

## What is KGEN?

KGEN (Knowledge Generation) is a deterministic code generation system that:

- **Generates identical output** from identical inputs
- **Tracks full provenance** of every generated artifact
- **Integrates semantic validation** using RDF and SHACL
- **Supports enterprise governance** with N3 rules
- **Works git-natively** with your existing workflows

### Key Principles

1. **Deterministic**: Same inputs = same outputs, always
2. **Traceable**: Full provenance chain for every artifact
3. **Semantic**: Rich knowledge modeling with RDF
4. **Secure**: Enterprise-grade security and compliance
5. **Git-native**: Version control first approach

## Step 1: Installation

### Install KGEN CLI

```bash
# Install globally
npm install -g @kgen/cli

# Verify installation
kgen version
# Expected output: KGEN v1.x.x

# Check available commands
kgen --help
```

### Initialize Your First Project

```bash
# Create project directory
mkdir my-kgen-project
cd my-kgen-project

# Initialize KGEN project
kgen init

# This creates:
# - kgen.config.js (configuration)
# - _templates/ (template directory)
# - .kgen/ (metadata and cache)
```

## Step 2: Understanding Templates

### Template Structure

KGEN templates are Nunjucks files with frontmatter:

```njk
---
to: {{outputPath}}
variables:
  variableName: type
inject: false
skipIf: "condition"
---
{{template content using Nunjucks syntax}}
```

### Your First Template

Let's create a simple component template:

```bash
# Create template directory
mkdir -p _templates/component

# Create the template file
touch _templates/component/index.js.njk
```

Edit `_templates/component/index.js.njk`:

```njk
---
to: src/components/{{componentName}}/index.js
variables:
  componentName: string
  description?: string
  withPropTypes?: boolean
inject: false
skipIf: "exists"
---
/**
 * {{componentName}} Component
{% if description %} * {{description}}{% endif %}
 * Generated by KGEN v1
 */

import React from 'react';
{% if withPropTypes %}import PropTypes from 'prop-types';{% endif %}

const {{componentName}} = ({ children, ...props }) => {
  return (
    <div className="{{componentName | kebabCase}}" {...props}>
      {children}
    </div>
  );
};

{% if withPropTypes %}
{{componentName}}.propTypes = {
  children: PropTypes.node
};
{% endif %}

export default {{componentName}};

// Generated at: {{new Date().toISOString()}}
// Template: _templates/component/index.js.njk
// KGEN v1 - Deterministic Code Generation
```

## Step 3: Generate Your First Component

### List Available Templates

```bash
kgen list
# Expected output:
# Available templates:
# - component: Component template
```

### Generate a Component

```bash
# Generate without PropTypes
kgen generate component \
  --componentName="Button" \
  --description="A reusable button component"

# Check the generated file
cat src/components/Button/index.js
```

### Generate with All Options

```bash
# Generate with PropTypes
kgen generate component \
  --componentName="Card" \
  --description="A flexible card container" \
  --withPropTypes=true
```

## Step 4: Understanding Deterministic Generation

### Test Determinism

Run the same generation command twice:

```bash
# First generation
kgen generate component --componentName="Modal" > output1.txt

# Second generation  
kgen generate component --componentName="Modal" > output2.txt

# Compare outputs
diff output1.txt output2.txt
# Should show no differences!
```

### View Generation Metadata

```bash
# Check generation history
kgen history

# View artifact details
kgen inspect src/components/Button/index.js

# Show provenance chain
kgen provenance src/components/Button/index.js
```

## Step 5: Working with Variables

### Dynamic Output Paths

Templates can use variables in output paths:

```njk
---
to: {{outputDir}}/{{componentName | kebabCase}}.{{fileExtension}}
variables:
  outputDir: string
  componentName: string
  fileExtension: string
---
```

### Variable Types

KGEN supports several variable types:

- `string`: Text values
- `number`: Numeric values  
- `boolean`: True/false flags
- `array`: Lists of values
- `object`: Complex data structures
- `date`: Date/time values

### Filters and Functions

KGEN provides built-in filters:

- `{{name | kebabCase}}` → `my-component`
- `{{name | pascalCase}}` → `MyComponent`
- `{{name | camelCase}}` → `myComponent`
- `{{name | snakeCase}}` → `my_component`
- `{{date | date('YYYY-MM-DD')}}` → `2025-09-12`

## Step 6: Basic Validation

### Create Validation Rules

Create `.kgen/rules/validation.n3`:

```n3
# Component name validation
{
    ?template kgen:hasVariable ?var .
    ?var kgen:variableName "componentName" .
    ?var kgen:variableValue ?value .
    ?value string:matches "^[A-Z][a-zA-Z0-9]*$" .
} => {
    ?template kgen:hasValidComponentName true .
} .
```

### Run Validation

```bash
# Validate current templates
kgen validate

# Validate specific template
kgen validate _templates/component/index.js.njk
```

## Step 7: Version Control Integration

### Initialize Git

```bash
# Initialize git repository
git init
git add .
git commit -m "Initial KGEN project setup"
```

### Ignore Generated Files (Optional)

Add to `.gitignore`:

```
# Generated artifacts (optional - you might want to commit these)
src/components/*/index.js

# KGEN cache (always ignore)
.kgen/cache/
```

### Git Hooks Integration

```bash
# Setup drift detection on commit
kgen setup-hooks

# This adds pre-commit hook to detect unauthorized changes
```

## Step 8: Workshop Templates

### Explore Workshop Examples

The workshop includes three main template categories:

```bash
# List workshop templates
ls examples/workshop/_templates/
# nextjs-app/     - Next.js page templates
# api-service/    - API route templates  
# office-report/  - Office document templates
```

### Try Next.js Page Generation

```bash
cd examples/workshop

# Generate a dashboard page
kgen generate nextjs-app/page \
  --pageName="Dashboard" \
  --title="Analytics Dashboard" \
  --description="Real-time analytics and metrics" \
  --withAuth=true
```

### Try API Service Generation

```bash
# Generate a products API
kgen generate api-service/route \
  --resourceName="products" \
  --withAuth=true \
  --withValidation=true \
  --methods=["GET","POST","PUT","DELETE"]
```

## Step 9: Semantic Knowledge

### View Knowledge Base

```bash
# Explore semantic knowledge
cat examples/workshop/knowledge/sample.ttl

# View SHACL validation shapes
cat examples/workshop/knowledge/shapes.ttl
```

### Query Knowledge Base

```bash
# Run SPARQL query to find all templates
kgen query "SELECT ?template ?label WHERE { 
  ?template a kgen:Template . 
  ?template rdfs:label ?label . 
}"
```

## Step 10: What's Next?

### Key Concepts Learned

✅ **Template Structure**: Frontmatter + Nunjucks content  
✅ **Deterministic Generation**: Identical inputs = identical outputs  
✅ **Variables and Filters**: Dynamic content generation  
✅ **Basic Validation**: N3 rules for template validation  
✅ **Git Integration**: Version control native workflows  
✅ **Semantic Knowledge**: RDF-based metadata modeling  

### Next Steps

1. **Tutorial 02**: Learn advanced deterministic generation techniques
2. **Tutorial 03**: Implement drift detection in CI/CD pipelines
3. **Explore Templates**: Try the workshop's advanced templates
4. **Create Custom Templates**: Build templates for your specific needs

### Common Commands Reference

```bash
# Template Management
kgen list                    # List available templates
kgen help <template>         # Get template documentation

# Generation
kgen generate <template> [options]  # Generate from template
kgen dry-run <template> [options]   # Preview without creating files

# Validation and History
kgen validate               # Validate templates and rules
kgen history               # Show generation history
kgen provenance <file>     # Show file provenance chain

# Project Management  
kgen init                  # Initialize new project
kgen config               # View configuration
kgen clean                # Clean cache and temporary files
```

## Troubleshooting

### Common Issues

**Issue**: `kgen: command not found`
**Solution**: Install globally: `npm install -g @kgen/cli`

**Issue**: Template not found
**Solution**: Ensure template is in `_templates/` directory and run `kgen list`

**Issue**: Generation fails with variable error
**Solution**: Check required variables with `kgen help <template>`

**Issue**: Permission denied
**Solution**: Check file permissions and ensure output directory exists

### Getting Help

```bash
# General help
kgen --help

# Command-specific help
kgen generate --help

# Template-specific help
kgen help <template-name>

# Debug mode
KGEN_DEBUG=1 kgen generate <template> [options]
```

## Conclusion

Congratulations! You've completed the KGEN Getting Started tutorial. You now understand:

- How to create and use KGEN templates
- The principles of deterministic generation
- Basic semantic validation with N3 rules
- Git-native workflows
- Variable types and filters

You're ready to move on to **Tutorial 02: Deterministic Generation** to learn advanced techniques for ensuring reproducible builds.

---

**Next**: [Tutorial 02: Deterministic Generation](02-deterministic-generation.md)  
**Back to**: [Workshop README](../README.md)