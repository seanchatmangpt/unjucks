---
to: "{{ resourceId | slug }}.rdf"
inject: true
skipIf: "{{ skipExisting | default(false) }}"
chmod: "644"
---
<?xml version="1.0" encoding="UTF-8"?>
<rdf:RDF 
  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:owl="http://www.w3.org/2002/07/owl#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:dct="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:schema="http://schema.org/"
  xmlns:void="http://rdfs.org/ns/void#"
  xmlns:geo="http://www.opengis.net/ont/geosparql#"
  xmlns:prov="http://www.w3.org/ns/prov#"
  {% if customNamespaces -%}
  {% for prefix, uri in customNamespaces -%}
  xmlns:{{ prefix }}="{{ uri }}"
  {% endfor -%}
  {% endif -%}
  xml:base="{{ baseUri | rdfResource }}">

  <!-- Resource Description: {{ title | titleCase }} -->
  <{{ resourceType | schemaOrg | getLocalName }} rdf:about="{{ resourceId | slug }}">
    
    <!-- Basic identification -->
    <schema:{{ nameProperty | camelCase | default('name') }} xml:lang="{{ language | default('en') }}">{{ title | titleCase | sparqlEscape }}</schema:{{ nameProperty | camelCase | default('name') }}>
    <schema:identifier rdf:datatype="http://www.w3.org/2001/XMLSchema#string">{{ resourceId | upper }}</schema:identifier>
    <schema:url rdf:resource="{{ resourceId | slug }}"/>
    {% if description -%}
    <schema:description xml:lang="{{ language | default('en') }}">{{ description | sparqlEscape }}</schema:description>
    {% endif -%}
    
    <!-- Keywords -->
    {% if keywords -%}
    {% for keyword in keywords -%}
    <schema:keywords xml:lang="{{ language | default('en') }}">{{ keyword | sparqlEscape }}</schema:keywords>
    {% endfor -%}
    {% endif -%}
    
    <!-- Temporal metadata -->
    {% if createdDate -%}
    <dct:created rdf:datatype="http://www.w3.org/2001/XMLSchema#dateTime">{{ createdDate | formatDate('YYYY-MM-DDTHH:mm:ss') }}</dct:created>
    {% endif -%}
    <dct:modified rdf:datatype="http://www.w3.org/2001/XMLSchema#dateTime">{{ now() | formatDate('YYYY-MM-DDTHH:mm:ss') }}</dct:modified>
    {% if validFrom -%}
    <schema:validFrom rdf:datatype="http://www.w3.org/2001/XMLSchema#date">{{ validFrom | formatDate('YYYY-MM-DD') }}</schema:validFrom>
    {% endif -%}
    {% if validThrough -%}
    <schema:validThrough rdf:datatype="http://www.w3.org/2001/XMLSchema#date">{{ validThrough | formatDate('YYYY-MM-DD') }}</schema:validThrough>
    {% endif -%}
    
    <!-- Authorship and provenance -->
    {% if creator -%}
    <dct:creator rdf:resource="{{ creator | slug }}"/>
    {% endif -%}
    {% if publisher -%}
    <dct:publisher rdf:resource="{{ publisher | slug }}"/>
    {% endif -%}
    {% if contributors -%}
    {% for contributor in contributors -%}
    <dct:contributor rdf:resource="{{ contributor | slug }}"/>
    {% endfor -%}
    {% endif -%}
    
    <!-- Rights and licensing -->
    {% if license -%}
    <dct:license rdf:resource="{{ license | licenseUri }}"/>
    {% endif -%}
    {% if rightsHolder -%}
    <dct:rightsHolder rdf:resource="{{ rightsHolder | slug }}"/>
    {% endif -%}
    {% if accessRights -%}
    <dct:accessRights xml:lang="{{ language | default('en') }}">{{ accessRights | sparqlEscape }}</dct:accessRights>
    {% endif -%}
    
    <!-- Technical metadata -->
    <schema:encodingFormat rdf:datatype="http://www.w3.org/2001/XMLSchema#string">{{ format | default('application/rdf+xml') | contentType }}</schema:encodingFormat>
    {% if version -%}
    <schema:version rdf:datatype="http://www.w3.org/2001/XMLSchema#string">{{ version }}</schema:version>
    {% endif -%}
    {% if size -%}
    <schema:contentSize rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">{{ size }}</schema:contentSize>
    {% endif -%}
    
    <!-- Web presence -->
    <schema:mainEntityOfPage rdf:resource="{{ resourceId | slug }}.html"/>
    {% if canonicalUrl -%}
    <schema:url rdf:resource="{{ canonicalUrl }}"/>
    {% endif -%}
    
    <!-- Dataset membership -->
    <void:inDataset rdf:resource="{{ dataset | kebabCase }}"/>
    
    <!-- Geospatial information -->
    {% if latitude and longitude -%}
    <geo:hasGeometry>
      <geo:Point>
        <geo:asWKT rdf:datatype="http://www.opengis.net/ont/geosparql#wktLiteral">{{ geoPoint(latitude, longitude) }}</geo:asWKT>
      </geo:Point>
    </geo:hasGeometry>
    {% endif -%}
    
    <!-- Address information -->
    {% if address -%}
    <schema:address>
      <schema:PostalAddress>
        {% if address.streetAddress -%}
        <schema:streetAddress xml:lang="{{ language | default('en') }}">{{ address.streetAddress | sparqlEscape }}</schema:streetAddress>
        {% endif -%}
        {% if address.locality -%}
        <schema:addressLocality xml:lang="{{ language | default('en') }}">{{ address.locality | sparqlEscape }}</schema:addressLocality>
        {% endif -%}
        {% if address.region -%}
        <schema:addressRegion xml:lang="{{ language | default('en') }}">{{ address.region | sparqlEscape }}</schema:addressRegion>
        {% endif -%}
        {% if address.postalCode -%}
        <schema:postalCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string">{{ address.postalCode }}</schema:postalCode>
        {% endif -%}
        {% if address.country -%}
        <schema:addressCountry xml:lang="{{ language | default('en') }}">{{ address.country | sparqlEscape }}</schema:addressCountry>
        {% endif -%}
      </schema:PostalAddress>
    </schema:address>
    {% endif -%}
    
    <!-- Content-specific properties for Person -->
    {% if resourceType == 'person' -%}
    {% if givenName -%}
    <foaf:givenName xml:lang="{{ language | default('en') }}">{{ givenName | sparqlEscape }}</foaf:givenName>
    {% endif -%}
    {% if familyName -%}
    <foaf:familyName xml:lang="{{ language | default('en') }}">{{ familyName | sparqlEscape }}</foaf:familyName>
    {% endif -%}
    {% if email -%}
    <foaf:mbox rdf:resource="mailto:{{ email }}"/>
    {% endif -%}
    {% if homepage -%}
    <foaf:homepage rdf:resource="{{ homepage }}"/>
    {% endif -%}
    {% endif -%}
    
    <!-- Content-specific properties for Organization -->
    {% if resourceType == 'organization' -%}
    {% if legalName -%}
    <schema:legalName xml:lang="{{ language | default('en') }}">{{ legalName | sparqlEscape }}</schema:legalName>
    {% endif -%}
    {% if foundingDate -%}
    <schema:foundingDate rdf:datatype="http://www.w3.org/2001/XMLSchema#date">{{ foundingDate | formatDate('YYYY-MM-DD') }}</schema:foundingDate>
    {% endif -%}
    {% if numberOfEmployees -%}
    <schema:numberOfEmployees rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">{{ numberOfEmployees }}</schema:numberOfEmployees>
    {% endif -%}
    {% endif -%}
    
    <!-- Content-specific properties for Dataset -->
    {% if resourceType == 'dataset' -%}
    {% if distribution -%}
    {% for dist in distribution -%}
    <dcat:distribution>
      <dcat:Distribution>
        <dct:format rdf:datatype="http://www.w3.org/2001/XMLSchema#string">{{ dist.format | contentType }}</dct:format>
        {% if dist.downloadUrl -%}
        <dcat:downloadURL rdf:resource="{{ dist.downloadUrl }}"/>
        {% endif -%}
        {% if dist.accessUrl -%}
        <dcat:accessURL rdf:resource="{{ dist.accessUrl }}"/>
        {% endif -%}
      </dcat:Distribution>
    </dcat:distribution>
    {% endfor -%}
    {% endif -%}
    {% endif -%}
    
    <!-- Custom properties -->
    {% if customProperties -%}
    {% for prop, values in customProperties -%}
    {% set expandedProp = prop | expandUri -%}
    {% set localName = expandedProp | getLocalName -%}
    {% set namespace = expandedProp | getNamespace -%}
    {% if values is iterable and values is not string -%}
    {% for value in values -%}
    <{{ localName }} {% if namespace %}xmlns="{{ namespace }}"{% endif %}>{{ value | sparqlEscape }}</{{ localName }}>
    {% endfor -%}
    {% else -%}
    <{{ localName }} {% if namespace %}xmlns="{{ namespace }}"{% endif %}>{{ values | sparqlEscape }}</{{ localName }}>
    {% endif -%}
    {% endfor -%}
    {% endif -%}
    
    <!-- External interlinking -->
    {% if externalLinks -%}
    {% for link in externalLinks -%}
    <owl:sameAs rdf:resource="{{ link }}"/>
    {% endfor -%}
    {% endif -%}
    
    <!-- Related resources -->
    {% if relatedResources -%}
    {% for related in relatedResources -%}
    <schema:relatedLink rdf:resource="{{ related.uri | default(related | slug) }}"/>
    {% if related.relation -%}
    <{{ related.relation | getLocalName }} rdf:resource="{{ related.uri | default(related | slug) }}"/>
    {% endif -%}
    {% endfor -%}
    {% endif -%}
    
    <!-- Provenance -->
    <prov:wasGeneratedBy>
      <prov:Activity>
        <prov:startedAtTime rdf:datatype="http://www.w3.org/2001/XMLSchema#dateTime">{{ now() | isoDate }}</prov:startedAtTime>
        <prov:wasAssociatedWith rdf:resource="{{ generator | default('unjucks-system') | slug }}"/>
        {% if generatorVersion -%}
        <prov:used>
          <prov:SoftwareAgent>
            <schema:version rdf:datatype="http://www.w3.org/2001/XMLSchema#string">{{ generatorVersion }}</schema:version>
          </prov:SoftwareAgent>
        </prov:used>
        {% endif -%}
      </prov:Activity>
    </prov:wasGeneratedBy>
    
  </{{ resourceType | schemaOrg | getLocalName }}>
  
  <!-- Additional resources referenced -->
  {% if creator -%}
  <foaf:Agent rdf:about="{{ creator | slug }}">
    <rdfs:label xml:lang="{{ language | default('en') }}">{{ creatorName | default('Resource Creator') | sparqlEscape }}</rdfs:label>
  </foaf:Agent>
  {% endif -%}
  
  {% if publisher -%}
  <foaf:Organization rdf:about="{{ publisher | slug }}">
    <rdfs:label xml:lang="{{ language | default('en') }}">{{ publisherName | default('Resource Publisher') | sparqlEscape }}</rdfs:label>
  </foaf:Organization>
  {% endif -%}
  
  <!-- Dataset metadata -->
  <void:Dataset rdf:about="{{ dataset | kebabCase }}">
    <dct:title xml:lang="{{ language | default('en') }}">{{ datasetTitle | default('Resource Dataset') | sparqlEscape }}</dct:title>
    <void:subset rdf:resource="{{ resourceId | slug }}"/>
  </void:Dataset>
  
  <!-- Document metadata -->
  <void:Dataset rdf:about="{{ resourceId | slug }}.rdf">
    <dct:title xml:lang="{{ language | default('en') }}">RDF/XML Description of {{ title | titleCase | sparqlEscape }}</dct:title>
    <dct:description xml:lang="{{ language | default('en') }}">RDF/XML serialization of {{ resourceType }} resource</dct:description>
    <dct:format rdf:datatype="http://www.w3.org/2001/XMLSchema#string">{{ 'application/rdf+xml' | contentType }}</dct:format>
    <dct:created rdf:datatype="http://www.w3.org/2001/XMLSchema#dateTime">{{ now() | isoDate }}</dct:created>
    <void:primaryTopic rdf:resource="{{ resourceId | slug }}"/>
    <dct:isFormatOf rdf:resource="{{ resourceId | slug }}"/>
  </void:Dataset>
  
</rdf:RDF>